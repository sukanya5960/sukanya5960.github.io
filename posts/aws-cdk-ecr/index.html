<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="layout-lang" content="en"><meta name="day-prompt" content="d ago"><meta name="hour-prompt" content="hr ago"><meta name="minute-prompt" content="min ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Infrastructure as Code Using AWS CDK" /><meta name="author" content="Sukanya M" /><meta property="og:locale" content="en" /><meta name="description" content="Let’s dive into how to programmatically create an ECR repository using the AWS Cloud Development Kit (CDK) with Python. CDK allows us to define our cloud infrastructure using familiar programming languages, making infrastructure as code (IaC) more accessible and maintainable." /><meta property="og:description" content="Let’s dive into how to programmatically create an ECR repository using the AWS Cloud Development Kit (CDK) with Python. CDK allows us to define our cloud infrastructure using familiar programming languages, making infrastructure as code (IaC) more accessible and maintainable." /><link rel="canonical" href="https://sukanya5960.github.io/posts/aws-cdk-ecr/" /><meta property="og:url" content="https://sukanya5960.github.io/posts/aws-cdk-ecr/" /><meta property="og:site_name" content="Sukanya M" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-09-21T07:45:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Infrastructure as Code Using AWS CDK" /><meta name="twitter:site" content="@sukanya5960" /><meta name="twitter:creator" content="@Sukanya M" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sukanya M"},"dateModified":"2024-09-21T07:45:00+05:30","datePublished":"2024-09-21T07:45:00+05:30","description":"Let’s dive into how to programmatically create an ECR repository using the AWS Cloud Development Kit (CDK) with Python. CDK allows us to define our cloud infrastructure using familiar programming languages, making infrastructure as code (IaC) more accessible and maintainable.","headline":"Infrastructure as Code Using AWS CDK","mainEntityOfPage":{"@type":"WebPage","@id":"https://sukanya5960.github.io/posts/aws-cdk-ecr/"},"url":"https://sukanya5960.github.io/posts/aws-cdk-ecr/"}</script><title>Infrastructure as Code Using AWS CDK | Sukanya M</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Sukanya M"><meta name="application-name" content="Sukanya M"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://raw.githubusercontent.com/sukanya5960/sukanya5960.github.io/master/assets/img/favicons/sukanya.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sukanya M</a></div><div class="site-subtitle font-italic">Cloud, DevOps, Site Reliability Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/sukanya5960" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/sukanya5960" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sukanya5960','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Infrastructure as Code Using AWS CDK</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Infrastructure as Code Using AWS CDK</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Sukanya M </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 21, 2024, 7:45 AM +0530" >Sep 21, 2024<i class="unloaded">2024-09-21T07:45:00+05:30</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="452 words">2 min read</span></div></div><div class="post-content"><p>Let’s dive into how to programmatically create an ECR repository using the AWS Cloud Development Kit (CDK) with Python. CDK allows us to define our cloud infrastructure using familiar programming languages, making infrastructure as code (IaC) more accessible and maintainable.</p><h4 id="prerequisites">Prerequisites:</h4><p>Before we begin, ensure you have the following set up:</p><ul><li>AWS Account: You’ll need an active AWS account.<li>AWS CLI Configured: The AWS Command Line Interface should be installed and configured with your credentials.<li>Python 3.6 or later: CDK Python requires a compatible Python version.<li>Node.js and npm: CDK CLI relies on Node.js and npm.<li>AWS CDK Toolkit Installed: If you haven’t already, install the CDK CLI globally:<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm install -g aws-cdk
</pre></table></code></div></div></ul><p>First, let’s create a new CDK project in Python. Open your terminal and navigate to your desired project directory. Then, run:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cdk init app --language python
</pre></table></code></div></div><p>Activate the virtual environment created by CDK:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>source .venv/bin/activate
</pre></table></code></div></div><p>Now, navigate to the project’s core file, typically located under the project’s root directory with a name similar to <your_project_name>_stack.py. We'll be adding our ECR repository definition here.</your_project_name></p><h4 id="defining-the-ecr-repository">Defining the ECR Repository:</h4><p>Import the necessary CDK modules and the aws_ecr module:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>from aws_cdk import core as cdk
from aws_cdk import aws_ecr as ecr
</pre></table></code></div></div><p>Inside your stack class (which inherits from cdk.Stack), you can now define your ECR repository. Here’s a basic example:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>class MyEcrStack(cdk.Stack):

    def __init__(self, scope: cdk.Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)

        repository = ecr.Repository(
            self,
            "MyWebAppRepo",
            repository_name="my-web-app-repo"  # Optional: Specify a custom repository name
        )

        cdk.CfnOutput(self, "RepositoryUri", value=repository.repository_uri)
</pre></table></code></div></div><p>In this code:</p><ul><li>We import the ecr module from aws_cdk.<li>We create an instance of ecr.Repository within our stack.<li>The first argument (self) refers to the current stack.<li>The second argument (“MyWebAppRepo”) is a logical ID for this resource within your CDK stack. It needs to be unique within the stack.<li>The repository_name parameter (optional) allows you to specify a custom name for your ECR repository in AWS. If you don’t provide it, CDK will generate a unique name.<li>cdk.CfnOutput is used to output the URI of the newly created repository after deployment, which is essential for pushing your Docker images.</ul><h4 id="deploying-your-cdk-stack">Deploying Your CDK Stack:</h4><p>Save your changes to the stack file. Now, in your terminal, navigate to the root of your CDK project and run the following commands:</p><ol><li>Synthesize the CloudFormation template:<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cdk synth
</pre></table></code></div></div><p>This command will generate the CloudFormation template based on your Python code.</p><li>Deploy the CDK stack to your AWS account:<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cdk deploy
</pre></table></code></div></div><p>CDK will prompt you for confirmation before creating the resources in your AWS account (in the AWS region you have configured). Type y to proceed.</p></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/aws/'>AWS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >AWS</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >Programming</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Infrastructure as Code Using AWS CDK - Sukanya M&url=https://sukanya5960.github.io/posts/aws-cdk-ecr/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Infrastructure as Code Using AWS CDK - Sukanya M&u=https://sukanya5960.github.io/posts/aws-cdk-ecr/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Infrastructure as Code Using AWS CDK - Sukanya M&url=https://sukanya5960.github.io/posts/aws-cdk-ecr/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/blue-green-deployment-rds/">Blue/Green Deployment in RDS</a><li><a href="/posts/bash-isp-ip-aws-sg/">Bash Script to Add ISP IP to Security Group</a><li><a href="/posts/asg-windows-ad/">Windows instance in autoscaling group automatically join to Active Directory</a><li><a href="/posts/cwagent-windows-asg/">AWS CloudwatchAgent Setup Windows with Autoscaling</a><li><a href="/posts/text-and-typography/">Text and Typography</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/devops/">devops</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/bash/">Bash</a> <a class="post-tag" href="/tags/database/">Database</a> <a class="post-tag" href="/tags/eks/">EKS</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/programming/">Programming</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/palindrome-python/"><div class="card-body"> <span class="timeago small" >Jun 16, 2022<i class="unloaded">2022-06-16T09:50:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python - make palindrome by replacing '?' in a string</h3><div class="text-muted small"><p> This is a program in Python which returns palindrome which can be obtained by replacing all of the question marks in the given string str with ‘Z’. If no palindrome can be obtained, the function wi...</p></div></div></a></div><div class="card"> <a href="/posts/identical-pairs-array-python/"><div class="card-body"> <span class="timeago small" >Jun 16, 2022<i class="unloaded">2022-06-16T17:50:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python - find number of identical pairs in an array</h3><div class="text-muted small"><p> Let’s see how to find number of pairs of elements of the array that are equal but that occuppy different positions in the array. That means, a pair of indices (P,Q) is called identical if 0 &lt;= P...</p></div></div></a></div><div class="card"> <a href="/posts/bash-isp-ip-aws-sg/"><div class="card-body"> <span class="timeago small" >Jun 14, 2023<i class="unloaded">2023-06-14T17:50:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bash Script to Add ISP IP to Security Group</h3><div class="text-muted small"><p> Suppose, you have an EC2 instance and you need to access it when you are travelling or changing your network provider. Accessing IP restricted AWS Services is a headache as you need to add your ISP...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/blue-green-deployment-rds/" class="btn btn-outline-primary" prompt="Older"><p>Blue/Green Deployment in RDS</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/sukanya5960">Sukanya M</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/devops/">devops</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/bash/">Bash</a> <a class="post-tag" href="/tags/database/">Database</a> <a class="post-tag" href="/tags/eks/">EKS</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/programming/">Programming</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://sukanya5960.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
